<%- include('../layout/userhead.ejs') %>


    <div class="container">
        <div class="forms-container">
            <div class="signin-signup">
                <form action="/signup" class="sign-in-form" method="post" id="signup-form">
                    <h2 class="title">Sign up</h2>
                    <div style="padding-bottom: 20px;">
                        <% if(typeof message !=='undefined' ){ %>
                            <p style="color: rgb(190, 0, 0);">
                                <%= message %>
                            </p>
                            <% } %>
                    </div>
                    <div class="input-field">
                        <i class="fas fa-user"></i>
                        <input type="text" placeholder="Username" name="name" autocomplete="off" required minlength="3" maxlength="20" pattern="[a-zA-Z0-9]+" title="Username must contain only letters and numbers, and be between 3 and 20 characters long." oninput="validateName()"
                        />

                    </div>
                    <div id="name-error" class="error-message" style="color: rgb(255, 0, 0);"></div>
                    <div class="input-field">
                        <i class="fas fa-envelope"></i>
                        <input type="email" placeholder="Email" name="email" required oninput="validateEmail(this)" />
                    </div>
                    <span id="email-error" class="error-message" style="color: rgb(255, 0, 0);"></span>

                    <div class="input-field">
                        <i class="fa-solid fa-phone"></i>
                        <input type="tel" placeholder="Mobile number" name="mobile" required oninput="validatePhone(this)" />
                    </div>
                    <span id="mobile-error" class="error-message" style="color: rgb(255, 0, 0);"></span>

                    <div class="input-field">
                        <i class="fas fa-lock"></i>
                        <input id="password-field" type="password" placeholder="Password" autocomplete="off" name="password" required oninput="validatePassword(this)" />
                    </div>
                    <span id="password-error" class="error-message" style="color: rgb(255, 0, 0);"></span>


                    <input type="submit" class="btn" value="Sign up" id="open" />
                </form>
            </div>
        </div>
        <div class="panels-container">
            <div class="panel left-panel">
                <div class="content">
                    <h3>One of us ?</h3>
                    <p>
                        With the trendiest, freshest, and most unique styles from across India and the world, ADDRESS invites you to express your personal style fearlessly.
                    </p>
                    <a href="/signin"><button class="btn transparent" id="sign-in-btn">
                    Sign in
                </button></a>
                </div>
                <img src="" class="image" alt="" />
            </div>
        </div>
    </div>

    <script>
        function validateName() {
            var nameInput = document.forms["signup-form"]["name"];
            var nameError = document.getElementById("name-error");

            if (nameInput.value === "") {
                nameError.innerHTML = "";
                nameInput.setCustomValidity("");
                return; // exit the function
            }

            if (nameInput.value.length < 3 || nameInput.value.length > 20) {
                nameError.innerHTML = "Username must be between 3 and 20 characters long.";
                nameInput.setCustomValidity("Invalid");
            } else if (!nameInput.value.match(/[a-zA-Z0-9]+/)) {
                nameError.innerHTML = "Username must contain only letters and numbers.";
                nameInput.setCustomValidity("Invalid");
            } else {
                nameError.innerHTML = "";
                nameInput.setCustomValidity("");
            }
        }
    </script>
    <script>
        function validateEmail(inputField) {
            const email = inputField.value.trim();
            const emailError = document.getElementById("email-error");

            if (email === "") {
                inputField.setCustomValidity("");
                emailError.innerHTML = "";
            } else if (!isValidEmail(email)) {
                inputField.setCustomValidity("Please enter a valid email address");
                emailError.innerHTML = "Please enter a valid email address";
            } else {
                inputField.setCustomValidity("");
                emailError.innerHTML = "";
            }
        }


        function isValidEmail(email) {
            // Regular expression for email validation with gmail.com domain
            const emailRegex = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((gmail\.com)|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

            return emailRegex.test(String(email).toLowerCase());
        }
    </script>
    <script>
        function validatePhone(inputField) {
            const phone = inputField.value.trim();
            const phoneError = document.getElementById("mobile-error");

            if (phone === "") {
                inputField.setCustomValidity("");
                phoneError.innerHTML = "";
            } else if (!isValidPhone(phone)) {
                inputField.setCustomValidity("Please enter a valid mobile number");
                phoneError.innerHTML = "Please enter a valid mobile number";
            } else {
                inputField.setCustomValidity("");
                phoneError.innerHTML = "";
            }
        }


        function isValidPhone(phone) {
            // Regular expression for phone number validation
            const phoneRegex = /^(\+?\d{1,3}[- ]?)?\d{10}$/;

            return phoneRegex.test(String(phone));
        }
    </script>
    <script>
        function validatePassword(inputField) {
            const password = inputField.value.trim();
            const passwordError = document.getElementById("password-error");

            if (password === "") {
                inputField.setCustomValidity("");
                passwordError.innerHTML = "";
            } else if (password.length < 8) {
                inputField.setCustomValidity("Password must be at least 8 characters long");
                passwordError.innerHTML = "Password must be at least 8 characters long";
            } else if (!/[a-z]/.test(password)) {
                inputField.setCustomValidity("Password must contain at least one lowercase letter");
                passwordError.innerHTML = "Password must contain at least one lowercase letter";
            } else if (!/[A-Z]/.test(password)) {
                inputField.setCustomValidity("Password must contain at least one uppercase letter");
                passwordError.innerHTML = "Password must contain at least one uppercase letter";
            } else if (!/\d/.test(password)) {
                inputField.setCustomValidity("Password must contain at least one digit");
                passwordError.innerHTML = "Password must contain at least one digit";
            } else if (!/[@$!%*?&]/.test(password)) {
                inputField.setCustomValidity("Password must contain at least one special character (@, $, !, %, *, ?, or &)");
                passwordError.innerHTML = "Password must contain at least one special character (@, $, !, %, *, ?, or &)";
            } else {
                inputField.setCustomValidity("");
                passwordError.innerHTML = "";
            }
        }
    </script>
    <%- include('../layout/userfooter.ejs') %>